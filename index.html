<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EVENT//HORIZON</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

:root {
  --paper:   #f0e6c8;
  --paper2:  #e8d9b0;
  --ink:     #1a1209;
  --ink50:   rgba(26,18,9,0.50);
  --ink20:   rgba(26,18,9,0.20);
  --ink08:   rgba(26,18,9,0.08);
  --amber:   #d4790a;
  --amber2:  #f0a030;
  --red:     #c0392b;
  --green:   #2d7a3a;
  --mono:    'Space Mono', monospace;
  --display: 'Syne', sans-serif;
}

html { scroll-behavior: smooth; }

body {
  font-family: var(--mono);
  background: var(--paper);
  color: var(--ink);
  min-height: 100vh;
  overflow-x: hidden;
  cursor: none;
}

/* â”€â”€ PAPER TEXTURE â”€â”€ */
body::before {
  content: '';
  position: fixed; inset: 0;
  background-image:
    repeating-linear-gradient(0deg, transparent, transparent 27px, var(--ink08) 28px);
  pointer-events: none; z-index: 0;
}

/* â”€â”€ CURSOR â”€â”€ */
#cur {
  position: fixed; width: 12px; height: 12px;
  border: 2px solid var(--ink);
  pointer-events: none; z-index: 9999;
  transform: translate(-50%,-50%);
  transition: transform .1s;
}
#cur.hover { transform: translate(-50%,-50%) scale(2); background: var(--amber); border-color: var(--amber); }

/* â”€â”€ PROGRESS BAR â”€â”€ */
#progress-bar {
  position: fixed; top: 0; left: 0; height: 4px;
  background: var(--ink); width: 0%;
  z-index: 1000; transition: width .08s linear;
}

/* â”€â”€ LOADING OVERLAY â”€â”€ */
#loading {
  position: fixed; inset: 0;
  background: var(--ink);
  z-index: 9999;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  gap: 2.4rem;
  transition: opacity .6s ease, visibility .6s;
}
#loading.gone { opacity: 0; visibility: hidden; pointer-events: none; }

.load-title {
  font-family: var(--display);
  font-size: clamp(2rem, 7vw, 5rem);
  font-weight: 800;
  color: var(--paper);
  letter-spacing: -.02em;
  line-height: 1;
  text-align: center;
}
.load-title small {
  display: block;
  font-size: .3em; letter-spacing: .4em;
  color: var(--amber2); font-family: var(--mono);
  font-weight: 400; margin-top: .5rem;
}

.load-track {
  width: min(380px, 80vw); height: 3px;
  background: rgba(240,230,200,.15);
}
.load-fill {
  height: 100%; background: var(--amber2);
  animation: loadup 2.6s cubic-bezier(.4,0,.2,1) forwards;
}
@keyframes loadup { 0%{width:0} 35%{width:40%} 70%{width:75%} 90%{width:92%} 100%{width:100%} }

.load-log {
  font-size: .65rem; letter-spacing: .15em;
  color: rgba(240,230,200,.4);
  text-transform: uppercase;
}
.load-log span { color: var(--amber2); animation: blink 1s step-end infinite; }

/* â”€â”€ HUD â€” left sidebar style â”€â”€ */
#hud {
  position: fixed; top: 0; left: 0; bottom: 0; width: 64px;
  border-right: 2px solid var(--ink20);
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  gap: 2rem; z-index: 900;
  background: var(--paper);
}
.hud-vert {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg);
  font-size: .55rem; letter-spacing: .25em;
  color: var(--ink50); text-transform: uppercase;
}
.hud-vert b { color: var(--ink); font-weight: 700; }
.hud-divider { width: 24px; height: 2px; background: var(--ink20); }
.hud-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--green); animation: pulse 2s ease infinite; }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.3} }

@media (max-width: 640px) { #hud { display: none; } }

/* â”€â”€ RESIZE MONITOR â€” upper right â”€â”€ */
#resize-monitor {
  position: fixed; top: 18px; right: 18px;
  background: var(--paper);
  border: 2px solid var(--ink);
  padding: 14px 18px; z-index: 901;
  min-width: 210px;
  box-shadow: 4px 4px 0 var(--ink);
}
.rm-title {
  font-size: .5rem; letter-spacing: .4em; text-transform: uppercase;
  color: var(--amber); border-bottom: 1px solid var(--ink20);
  padding-bottom: 8px; margin-bottom: 10px;
  display: flex; align-items: center; gap: 8px;
}
.rm-live {
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--green); animation: pulse 2s ease infinite;
  flex-shrink: 0;
}
.rm-live.firing { background: var(--amber); animation: none; }
.rm-row {
  display: flex; justify-content: space-between; align-items: baseline;
  font-size: .6rem; padding: 3px 0; gap: 12px;
}
.rm-row .k { color: var(--ink50); }
.rm-row .v { color: var(--ink); font-weight: 700; }
.rm-row .v.mobile  { color: #1a6fa8; }
.rm-row .v.tablet  { color: var(--amber); }
.rm-row .v.desktop { color: var(--green); }
.rm-bar-track {
  margin-top: 10px; height: 2px;
  background: var(--ink08); position: relative; overflow: hidden;
}
.rm-bar-fill {
  height: 100%; background: var(--amber);
  width: 0%; transition: width .15s ease;
}
.rm-event-log {
  margin-top: 10px; font-size: .5rem; letter-spacing: .1em;
  color: var(--ink20); border-top: 1px solid var(--ink08);
  padding-top: 8px; height: 42px; overflow: hidden;
}
.rm-event-log .log-line {
  color: var(--ink50); line-height: 1.8;
  animation: fadeIn .2s ease;
}
.rm-event-log .log-line.new { color: var(--amber); }
@keyframes fadeIn { from{opacity:0; transform:translateY(-4px)} to{opacity:1; transform:none} }

/* â”€â”€ MAIN CONTENT â€” offset by sidebar â”€â”€ */
main { margin-left: 64px; position: relative; z-index: 1; }
@media (max-width: 640px) { main { margin-left: 0; } }

/* â”€â”€ RESIZE TOAST â”€â”€ */
#resize-toast {
  position: fixed; bottom: 0; left: 64px; right: 0;
  background: var(--ink); color: var(--paper);
  padding: 10px 24px;
  font-size: .6rem; letter-spacing: .3em; text-transform: uppercase;
  z-index: 800; transform: translateY(100%);
  transition: transform .3s ease;
  border-top: 2px solid var(--amber);
}
#resize-toast.show { transform: translateY(0); }

/* â”€â”€ BOSS BANNER â”€â”€ */
#boss-banner {
  position: fixed; top: 0; left: 64px; right: 0;
  background: var(--red); color: var(--paper);
  padding: 12px 24px;
  font-size: .65rem; letter-spacing: .3em; text-transform: uppercase;
  z-index: 800; transform: translateY(-100%);
  transition: transform .4s ease;
  display: flex; align-items: center; justify-content: space-between;
}
#boss-banner.show { transform: translateY(0); }
#boss-dismiss {
  background: none; border: 1px solid var(--paper);
  color: var(--paper); font-family: var(--mono);
  font-size: .55rem; letter-spacing: .2em;
  padding: 4px 12px; cursor: pointer;
}
#boss-dismiss:hover { background: var(--paper); color: var(--red); }

/* â”€â”€ SECTIONS â”€â”€ */
section { padding: 6rem 4rem; border-bottom: 2px solid var(--ink20); }
@media (max-width: 640px) { section { padding: 4rem 1.5rem; } }

/* â”€â”€ HERO â”€â”€ */
.hero {
  min-height: 100vh;
  display: grid;
  grid-template-rows: auto 1fr auto;
  align-items: center;
  padding: 4rem;
}
.hero-top {
  font-size: .6rem; letter-spacing: .5em; color: var(--amber);
  text-transform: uppercase; border-bottom: 1px solid var(--ink20);
  padding-bottom: 1rem; margin-bottom: 3rem;
  display: flex; justify-content: space-between;
}
.hero-body { }
.hero h1 {
  font-family: var(--display);
  font-size: clamp(3.5rem, 12vw, 10rem);
  font-weight: 800; line-height: .88;
  letter-spacing: -.03em; color: var(--ink);
}
.hero h1 em {
  color: var(--amber); font-style: normal;
  display: block; font-size: .55em;
  letter-spacing: -.01em;
}
.hero-desc {
  margin-top: 3rem; max-width: 420px;
  font-size: .75rem; line-height: 2;
  color: var(--ink50); font-style: italic;
}
.hero-scroll {
  font-size: .55rem; letter-spacing: .4em;
  text-transform: uppercase; color: var(--ink20);
  animation: blink 2s step-end infinite;
  padding-top: 4rem;
}
@keyframes blink { 50%{opacity:0} }

/* â”€â”€ LEVEL SECTIONS â”€â”€ */
.level {
  display: grid;
  grid-template-columns: 80px 1fr;
  gap: 0 3rem;
  min-height: 70vh; align-items: center;
  opacity: .25; filter: sepia(.6);
  transform: translateX(-16px);
  transition: opacity .7s ease, filter .7s ease, transform .7s ease;
}
.level.unlocked { opacity: 1; filter: none; transform: none; }

@media (max-width: 640px) {
  .level { grid-template-columns: 1fr; gap: 1.5rem; }
}

.level-num {
  font-family: var(--display);
  font-size: 5rem; font-weight: 800;
  color: var(--ink08); line-height: 1;
  letter-spacing: -.04em;
  user-select: none;
}
.level.unlocked .level-num { color: var(--amber2); }

.level-body { }
.level-tag {
  font-size: .55rem; letter-spacing: .4em;
  text-transform: uppercase; color: var(--amber);
  margin-bottom: .8rem;
}
.level h2 {
  font-family: var(--display);
  font-size: clamp(1.8rem, 4vw, 3.2rem);
  font-weight: 800; line-height: 1.1; letter-spacing: -.02em;
  color: var(--ink); margin-bottom: 1.2rem;
}
.level p {
  font-size: .72rem; line-height: 2; color: var(--ink50);
  max-width: 520px;
}
code {
  font-family: var(--mono); background: var(--ink08);
  padding: 1px 5px; font-size: .85em;
  border: 1px solid var(--ink20);
}

.unlock-tag {
  display: inline-block; margin-top: 1.5rem;
  font-size: .55rem; letter-spacing: .35em; text-transform: uppercase;
  color: var(--green); border: 1px solid var(--green);
  padding: 4px 12px;
  opacity: 0; transform: translateY(6px);
  transition: opacity .4s ease .6s, transform .4s ease .6s;
}
.level.unlocked .unlock-tag { opacity: 1; transform: none; }

/* Alternating layout */
.level:nth-child(even) { grid-template-columns: 1fr 80px; }
.level:nth-child(even) .level-num { order: 2; text-align: right; }
.level:nth-child(even) .level-body { order: 1; }
@media (max-width: 640px) {
  .level:nth-child(even) { grid-template-columns: 1fr; }
  .level:nth-child(even) .level-num,
  .level:nth-child(even) .level-body { order: unset; }
}

/* â”€â”€ BOSS â”€â”€ */
.boss {
  min-height: 100vh;
  display: flex; flex-direction: column;
  align-items: flex-start; justify-content: center;
  background: var(--ink); color: var(--paper);
  opacity: .1; transform: none;
  transition: opacity .8s ease;
  border-bottom: none;
}
.boss.unlocked { opacity: 1; }

.boss-tag {
  font-size: .55rem; letter-spacing: .5em;
  text-transform: uppercase; color: var(--amber2);
  margin-bottom: 1.5rem;
}
.boss h2 {
  font-family: var(--display);
  font-size: clamp(3rem, 10vw, 8rem);
  font-weight: 800; letter-spacing: -.03em; line-height: .9;
  color: var(--paper);
}
.boss h2 em {
  color: var(--amber2); font-style: normal; display: block;
}
.boss p {
  max-width: 500px; margin-top: 2rem;
  font-size: .72rem; line-height: 2;
  color: rgba(240,230,200,.5);
}
.btn-boss {
  margin-top: 3rem; padding: 1rem 2.5rem;
  border: 2px solid var(--amber2); background: transparent;
  color: var(--amber2); font-family: var(--mono);
  font-size: .65rem; letter-spacing: .4em; text-transform: uppercase;
  cursor: pointer; transition: background .3s, color .3s;
}
.btn-boss:hover { background: var(--amber2); color: var(--ink); }

.boss-unlock {
  display: inline-block; margin-top: 2rem;
  font-size: .55rem; letter-spacing: .35em; text-transform: uppercase;
  color: var(--green); border: 1px solid var(--green); padding: 4px 12px;
  opacity: 0; transition: opacity .4s ease .7s;
}
.boss.unlocked .boss-unlock { opacity: 1; }

/* â”€â”€ FOOTER â”€â”€ */
footer {
  background: var(--ink); color: rgba(240,230,200,.25);
  padding: 2rem 4rem;
  font-size: .55rem; letter-spacing: .35em; text-transform: uppercase;
  display: flex; justify-content: space-between; align-items: center;
}
@media (max-width: 640px) { footer { flex-direction: column; gap: 1rem; padding: 2rem 1.5rem; } }
</style>
</head>
<body>

<div id="cur"></div>
<div id="progress-bar"></div>

<!-- Loading -->
<div id="loading">
  <div class="load-title">
    EVENT//<br>HORIZON
    <small>Window Events Â· The Reckoning</small>
  </div>
  <div class="load-track"><div class="load-fill"></div></div>
  <div class="load-log">Initializing quest engine <span>_</span></div>
</div>

<!-- HUD Sidebar -->
<div id="hud">
  <div class="hud-dot"></div>
  <div class="hud-divider"></div>
  <div class="hud-vert"><b id="hud-device">DESKTOP</b></div>
  <div class="hud-vert" id="hud-dims">1440Ã—900</div>
  <div class="hud-divider"></div>
  <div class="hud-vert">SCROLL <b id="hud-scroll">0%</b></div>
  <div class="hud-divider"></div>
  <div class="hud-vert">UNLOCKED <b id="hud-count">0/6</b></div>
</div>

<!-- Resize Monitor â€” upper right -->
<div id="resize-monitor">
  <div class="rm-title">
    <div class="rm-live" id="rm-dot"></div>
    Resize Monitor
  </div>
  <div class="rm-row"><span class="k">WIDTH</span><span class="v" id="rm-w">â€”</span></div>
  <div class="rm-row"><span class="k">HEIGHT</span><span class="v" id="rm-h">â€”</span></div>
  <div class="rm-row"><span class="k">DEVICE</span><span class="v" id="rm-device">â€”</span></div>
  <div class="rm-row"><span class="k">EVENTS</span><span class="v" id="rm-count">0</span></div>
  <div class="rm-bar-track"><div class="rm-bar-fill" id="rm-bar"></div></div>
  <div class="rm-event-log" id="rm-log"><div class="log-line">â€” Waiting for resize â€”</div></div>
</div>

<!-- Resize toast -->
<div id="resize-toast">âš™ Resize detected â€” layout updated</div>

<!-- Boss banner -->
<div id="boss-banner">
  âš  Boss Approaching â€” Prepare Yourself
  <button id="boss-dismiss">CLOSE âœ•</button>
</div>

<main>

  <!-- HERO -->
  <section class="hero">
    <div class="hero-top">
      <span>EVENT//HORIZON Â· v2.0</span>
      <span id="hero-date">WINDOW EVENTS CHALLENGE</span>
    </div>
    <div class="hero-body">
      <h1>
        Start<br>
        <em>Your Quest</em>
      </h1>
      <p class="hero-desc">
        Three events rule the browser. <code>load</code>, <code>resize</code>, <code>scroll</code>. Master all three and the Window Object bows to you. Fail, and the page remains forever locked.
      </p>
    </div>
    <div class="hero-scroll">â†“ scroll to unlock the levels â†“</div>
  </section>

  <!-- LEVELS -->
  <section class="level" id="lv1">
    <div class="level-num">01</div>
    <div class="level-body">
      <div class="level-tag">Level 01 Â· Load Event</div>
      <h2>The<br>Awakening</h2>
      <p>The <code>window.load</code> event fires when the page and all its assets â€” images, scripts, fonts â€” are completely ready. It is the moment your quest truly begins. Use it to dismiss loading screens, initialize state, and start animations.</p>
      <div class="unlock-tag">âœ“ UNLOCKED</div>
    </div>
  </section>

  <section class="level" id="lv2">
    <div class="level-num">02</div>
    <div class="level-body">
      <div class="level-tag">Level 02 Â· Resize Event</div>
      <h2>The<br>Shapeshifter</h2>
      <p>The <code>window.resize</code> event fires on every viewport change. Without protection it runs hundreds of times per second â€” a performance killer. Wrap it in a <code>debounce(fn, 150)</code> and it waits patiently until the user is done resizing. The HUD sidebar updates live as you resize this window.</p>
      <div class="unlock-tag">âœ“ UNLOCKED</div>
    </div>
  </section>

  <section class="level" id="lv3">
    <div class="level-num">03</div>
    <div class="level-body">
      <div class="level-tag">Level 03 Â· Scroll Event</div>
      <h2>The<br>Descent</h2>
      <p>The <code>window.scroll</code> event fires on every pixel of movement â€” potentially 60 times per second. Throttle it to run at most once every 80ms. Use it to fill the progress bar at the top of this page and trigger section unlocks as you descend.</p>
      <div class="unlock-tag">âœ“ UNLOCKED</div>
    </div>
  </section>

  <section class="level" id="lv4">
    <div class="level-num">04</div>
    <div class="level-body">
      <div class="level-tag">Level 04 Â· Throttle</div>
      <h2>The<br>Throttle</h2>
      <p>Throttle limits execution to once every N milliseconds. Ideal for <code>scroll</code> and <code>mousemove</code>. The function fires at the start of each interval â€” steady, rhythmic, predictable. This page's scroll handler is throttled to 80ms.</p>
      <div class="unlock-tag">âœ“ UNLOCKED</div>
    </div>
  </section>

  <section class="level" id="lv5">
    <div class="level-num">05</div>
    <div class="level-body">
      <div class="level-tag">Level 05 Â· Debounce</div>
      <h2>The<br>Silence</h2>
      <p>Debounce waits for a burst of events to stop before firing. Ideal for <code>resize</code>, <code>input</code>, and search. The function fires at the end â€” calm, deliberate, once. This page's resize handler is debounced at 150ms. Try resizing the window.</p>
      <div class="unlock-tag">âœ“ UNLOCKED</div>
    </div>
  </section>

  <!-- BOSS -->
  <section class="boss" id="boss">
    <div style="padding: 6rem 4rem;">
      <div class="boss-tag">Final Boss Â· The Window Object</div>
      <h2>
        Window<br>
        <em>Object</em>
      </h2>
      <p>The supreme ruler of the browser. It controls all three events: <code>load</code>, <code>resize</code>, <code>scroll</code>. It owns the global scope, the history, the location. Only those who have mastered throttle, debounce, and viewport math may face it.</p>
      <button class="btn-boss">âš” ACCEPT THE FINAL CHALLENGE</button>
      <div class="boss-unlock">ðŸ‘‘ BOSS UNLOCKED</div>
    </div>
  </section>

  <footer>
    <span>EVENT//HORIZON Â· Window Events Challenge</span>
    <span id="footer-count">0 of 6 levels unlocked</span>
  </footer>

</main>

<script>
// â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function throttle(fn, ms) {
  let last = 0;
  return function(...args) {
    const now = Date.now();
    if (now - last >= ms) { last = now; fn.apply(this, args); }
  };
}
function debounce(fn, ms) {
  let timer;
  return function(...args) { clearTimeout(timer); timer = setTimeout(() => fn.apply(this, args), ms); };
}

// â”€â”€ CURSOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const cur = document.getElementById('cur');
let mx = 0, my = 0;
document.addEventListener('mousemove', e => {
  mx = e.clientX; my = e.clientY;
  cur.style.left = mx + 'px'; cur.style.top = my + 'px';
});
document.querySelectorAll('button, a, code, .level').forEach(el => {
  el.addEventListener('mouseenter', () => cur.classList.add('hover'));
  el.addEventListener('mouseleave', () => cur.classList.remove('hover'));
});

// â”€â”€ HUD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let unlockedCount = 0;
const TOTAL = 6;

function deviceLabel(w) {
  if (w < 640) return ['MOBILE', 'mobile'];
  if (w < 900) return ['TABLET', 'tablet'];
  return ['DESKTOP', 'desktop'];
}

function updateHUD() {
  const w = window.innerWidth, h = window.innerHeight;
  document.getElementById('hud-dims').textContent = w + 'Ã—' + h;
  document.getElementById('hud-device').textContent = deviceLabel(w)[0];
}

function updateCounts() {
  document.getElementById('hud-count').textContent = unlockedCount + '/' + TOTAL;
  document.getElementById('footer-count').textContent = unlockedCount + ' of ' + TOTAL + ' levels unlocked';
}

// â”€â”€ RESIZE MONITOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let resizeEventCount = 0;
const logEl = document.getElementById('rm-log');
const rmDot = document.getElementById('rm-dot');
let rmDotTimer;

// Raw listener â€” fires every resize (unthrottled, for the monitor display)
window.addEventListener('resize', () => {
  resizeEventCount++;
  const w = window.innerWidth, h = window.innerHeight;
  const [label, cls] = deviceLabel(w);

  document.getElementById('rm-w').textContent = w + 'px';
  document.getElementById('rm-h').textContent = h + 'px';
  document.getElementById('rm-count').textContent = resizeEventCount;

  const devEl = document.getElementById('rm-device');
  devEl.textContent = label;
  devEl.className = 'v ' + cls;

  // Bar shows width as % of a generous 2400px reference
  document.getElementById('rm-bar').style.width = Math.min((w / 2400) * 100, 100) + '%';

  // Live dot flash
  rmDot.classList.add('firing');
  clearTimeout(rmDotTimer);
  rmDotTimer = setTimeout(() => rmDot.classList.remove('firing'), 300);

  // Log entry (keep last 2)
  const line = document.createElement('div');
  line.className = 'log-line new';
  line.textContent = `${w}Ã—${h} Â· ${label}`;
  logEl.innerHTML = '';
  logEl.appendChild(line);
  setTimeout(() => line.classList.remove('new'), 400);
});

// â”€â”€ LOAD EVENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.addEventListener('load', () => {
  setTimeout(() => {
    document.getElementById('loading').classList.add('gone');
    updateHUD();
    updateResizeMonitorInit();
    checkUnlocks();
  }, 2800);
});

function updateResizeMonitorInit() {
  const w = window.innerWidth, h = window.innerHeight;
  const [label, cls] = deviceLabel(w);
  document.getElementById('rm-w').textContent = w + 'px';
  document.getElementById('rm-h').textContent = h + 'px';
  const devEl = document.getElementById('rm-device');
  devEl.textContent = label;
  devEl.className = 'v ' + cls;
  document.getElementById('rm-bar').style.width = Math.min((w / 2400) * 100, 100) + '%';
  logEl.innerHTML = '<div class="log-line">â€” Try resizing the window â€”</div>';
}

// â”€â”€ RESIZE EVENT (debounced 150ms) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let toastTimer;
const onResize = debounce(() => {
  updateHUD();
  const toast = document.getElementById('resize-toast');
  toast.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => toast.classList.remove('show'), 2000);
}, 150);

window.addEventListener('resize', onResize);

// â”€â”€ SCROLL EVENT (throttled 80ms) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getScrollPct() {
  const max = document.documentElement.scrollHeight - window.innerHeight;
  return max > 0 ? window.scrollY / max : 0;
}

let bossShown = false, bossDismissed = false;

function checkUnlocks() {
  const vBottom = window.scrollY + window.innerHeight;
  document.querySelectorAll('.level, .boss').forEach(sec => {
    if (!sec.classList.contains('unlocked')) {
      const top = sec.getBoundingClientRect().top + window.scrollY;
      if (vBottom > top + sec.offsetHeight * 0.1) {
        sec.classList.add('unlocked');
        unlockedCount++;
        updateCounts();
      }
    }
  });
}

const onScroll = throttle(() => {
  const p = getScrollPct();
  document.getElementById('progress-bar').style.width = (p * 100) + '%';
  document.getElementById('hud-scroll').textContent = Math.round(p * 100) + '%';
  checkUnlocks();

  const banner = document.getElementById('boss-banner');
  if (p >= 0.7 && !bossShown && !bossDismissed) {
    bossShown = true;
    banner.classList.add('show');
    setTimeout(() => { if (!bossDismissed) banner.classList.remove('show'); }, 5000);
  }
  if (p < 0.65) bossShown = false;
}, 80);

window.addEventListener('scroll', onScroll);

// â”€â”€ BOSS DISMISS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('boss-dismiss').addEventListener('click', () => {
  bossDismissed = true;
  document.getElementById('boss-banner').classList.remove('show');
});

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
updateHUD();
updateCounts();
updateResizeMonitorInit();
</script>
</body>
</html>